// Generated by CoffeeScript 1.9.3
(function() {
  var backbone, collections, colors, mongodb;

  backbone = require('backbone4000');

  mongodb = require('mongodb');

  collections = require('collections/serverside');

  colors = require('colors');

  exports.lego = backbone.Model.extend4000({
    after: 'logger',
    init: function(callback) {
      this.env.db = new mongodb.Db(this.settings.name, new mongodb.Server(this.settings.host || 'localhost', this.settings.port || 27017), {
        safe: true
      });
      return this.env.db.open((function(_this) {
        return function() {
          var data;
          data = colors.green('mongodb://' + _this.env.db.serverConfig.host + ":" + _this.env.db.serverConfig.port);
          if (_this.legos.logger) {
            _this.env.log("init db (" + data + ")", {}, 'init', 'ok');
          }
          return callback(void 0, data);
        };
      })(this));
    }
  });

}).call(this);
